<!DOCTYPE html>
<html>
<head>
    <title>Cathay Rent API Documentation</title>
    <meta charset="UTF-8">
    <link rel="stylesheet" type="text/css" href="https://unpkg.com/swagger-ui-dist@5.0.0/swagger-ui.css" />
    <style>
        html {
            box-sizing: border-box;
            overflow: -moz-scrollbars-vertical;
            overflow-y: scroll;
        }
        *, *:before, *:after {
            box-sizing: inherit;
        }
        body {
            margin: 0;
            background: #fafafa;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        .swagger-ui .topbar {
            background-color: #3498db;
        }
        .swagger-ui .topbar .download-url-wrapper .select-label {
            color: #fff;
        }
        .custom-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px 20px;
            text-align: center;
            margin-bottom: 0;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .custom-header h1 {
            margin: 0;
            font-size: 2.8em;
            font-weight: 300;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }
        .custom-header p {
            margin: 15px 0 0 0;
            font-size: 1.3em;
            opacity: 0.9;
        }
        .custom-header .subtitle {
            margin: 10px 0;
            font-size: 1.1em;
            opacity: 0.8;
            font-style: italic;
        }

        .api-guide {
            background: #ffffff;
            margin: 20px;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border-left: 5px solid #3498db;
        }

        .guide-section {
            margin-bottom: 25px;
        }

        .guide-section h3 {
            color: #2c3e50;
            margin-bottom: 12px;
            font-size: 1.3em;
            border-bottom: 2px solid #ecf0f1;
            padding-bottom: 8px;
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .feature-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #27ae60;
        }

        .feature-card h4 {
            margin: 0 0 10px 0;
            color: #27ae60;
            font-size: 1.1em;
        }

        .code-example {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 6px;
            font-family: 'Consolas', 'Monaco', monospace;
            margin: 10px 0;
            overflow-x: auto;
            font-size: 14px;
            line-height: 1.4;
        }

        .response-example {
            background: #e8f5e8;
            border: 1px solid #27ae60;
            padding: 15px;
            border-radius: 6px;
            margin: 10px 0;
        }

        .quick-links {
            background: #f8f9fa;
            padding: 25px;
            border-bottom: 1px solid #dee2e6;
        }
        .quick-links h3 {
            margin-top: 0;
            color: #495057;
            font-size: 1.4em;
        }
        .quick-links a {
            display: inline-block;
            margin: 8px 12px 8px 0;
            padding: 10px 18px;
            background: #007bff;
            color: white;
            text-decoration: none;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s ease;
            box-shadow: 0 2px 4px rgba(0,123,255,0.3);
        }
        .quick-links a:hover {
            background: #0056b3;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,123,255,0.4);
        }
        .mapping-info {
            background: #e9ecef;
            padding: 20px;
            margin: 15px 0;
            border-radius: 8px;
            font-family: monospace;
            font-size: 14px;
            border-left: 4px solid #6c757d;
        }

        .privacy-note {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
        }

        .privacy-note strong {
            color: #dc6545;
        }

        .api-endpoint {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            padding: 12px;
            border-radius: 6px;
            margin: 8px 0;
            font-family: monospace;
        }

        .method-get {
            background: #d4edda;
            color: #155724;
            padding: 4px 8px;
            border-radius: 4px;
            font-weight: bold;
            font-size: 12px;
            margin-right: 8px;
        }

        .collapsible {
            background-color: #f1f1f1;
            color: #444;
            cursor: pointer;
            padding: 15px;
            width: 100%;
            border: none;
            text-align: left;
            outline: none;
            font-size: 16px;
            font-weight: 500;
            border-radius: 6px;
            margin: 8px 0;
            transition: background-color 0.3s;
        }

        .collapsible:hover {
            background-color: #ddd;
        }

        .collapsible:after {
            content: '\002B';
            color: #777;
            font-weight: bold;
            float: right;
            margin-left: 5px;
        }

        .active:after {
            content: "\2212";
        }

        .content {
            padding: 0 18px;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.2s ease-out;
            background-color: #f9f9f9;
            border-radius: 0 0 6px 6px;
        }

        .content.show {
            max-height: 1000px;
            padding: 18px;
        }
    </style>
</head>
<body>
    <div class="custom-header">
        <h1>Cathay Test Demo 591-Rent-House Data API Service</h1>
        <p>591 æˆ¿å±‹ç§Ÿè³ƒè³‡æ–™æŸ¥è©¢æœå‹™ v2.0.0</p>
        <div class="subtitle">æä¾›å¼·å¤§çš„æˆ¿å±‹æœå°‹èˆ‡çµ±è¨ˆåŠŸèƒ½ | ğŸ”’ å€‹è³‡ä¿è­·æ©Ÿåˆ¶ | ğŸ“Š å¯¦æ™‚è³‡æ–™åˆ†æ</div>
    </div>

    <div class="api-guide">
        <div class="guide-section">
            <h3>ğŸ¯ API åŠŸèƒ½æ¦‚è¦½</h3>
            <div class="feature-grid">
                <div class="feature-card">
                    <h4>ğŸ” æ™ºèƒ½æœå°‹</h4>
                    <p>æ”¯æ´å¤šæ¢ä»¶çµ„åˆæœå°‹ï¼šæˆ¿å±‹é¡å‹ã€åƒ¹æ ¼ç¯„åœã€ç™¼å¸ƒè€…é¡å‹ã€é—œéµå­—ç­‰</p>
                </div>
                <div class="feature-card">
                    <h4>ğŸ“Š è³‡æ–™çµ±è¨ˆ</h4>
                    <p>æä¾›å®Œæ•´çš„å¸‚å ´çµ±è¨ˆåˆ†æï¼ŒåŒ…å«åƒ¹æ ¼è¦†è“‹ç‡ã€ç™¼å¸ƒè€…åˆ†æç­‰</p>
                </div>
                <div class="feature-card">
                    <h4>ğŸ”’ éš±ç§ä¿è­·</h4>
                    <p>æ‰‹æ©Ÿè™Ÿç¢¼æ™ºèƒ½é®ç½©è™•ç†ï¼Œä¿è­·å€‹äººéš±ç§è³‡è¨Š</p>
                </div>
                <div class="feature-card">
                    <h4>âš¡ é«˜æ•ˆèƒ½</h4>
                    <p>Redis å¿«å–æ©Ÿåˆ¶ + BigQuery æœ€ä½³åŒ–ï¼Œæä¾›æ¯«ç§’ç´šå›æ‡‰</p>
                </div>
            </div>
        </div>

        <button class="collapsible">ğŸ“š å¿«é€Ÿä¸Šæ‰‹æŒ‡å—</button>
        <div class="content">
            <h4>1ï¸âƒ£ åŸºæœ¬æœå°‹</h4>
            <div class="code-example">GET /api/properties?limit=5</div>
            <p>å–å¾—å‰5ç­†æˆ¿å±‹è³‡æ–™ï¼Œé©åˆåˆå§‹è¼‰å…¥æˆ–æ¸¬è©¦é€£æ¥</p>

            <h4>2ï¸âƒ£ æ¢ä»¶æœå°‹</h4>
            <div class="code-example">GET /api/properties?house_type_id=2&min_price=15000&max_price=40000</div>
            <p>æœå°‹é›»æ¢¯å¤§æ¨“ï¼Œåƒ¹æ ¼ç¯„åœ 15,000-40,000 å…ƒ</p>

            <h4>3ï¸âƒ£ é—œéµå­—æœå°‹</h4>
            <div class="code-example">GET /api/properties?keyword=çƒæ—¥&limit=10</div>
            <p>æœå°‹åŒ…å«ã€Œçƒæ—¥ã€é—œéµå­—çš„ç‰©ä»¶</p>

            <h4>4ï¸âƒ£ åˆ†é æŸ¥è©¢</h4>
            <div class="code-example">GET /api/properties?limit=20&offset=40</div>
            <p>å–å¾—ç¬¬3é è³‡æ–™ï¼ˆæ¯é 20ç­†ï¼Œè·³éå‰40ç­†ï¼‰</p>
        </div>

        <button class="collapsible">ğŸ”— å®Œæ•´ API ç«¯é»èªªæ˜</button>
        <div class="content">
            <div class="api-endpoint">
                <span class="method-get">GET</span>
                <strong>/api/properties</strong> - æˆ¿å±‹ç‰©ä»¶æœå°‹
                <p>æ”¯æ´åƒæ•¸ï¼šhouse_type_id, poster_type_id, min_price, max_price, keyword, limit, offset</p>
            </div>

            <div class="api-endpoint">
                <span class="method-get">GET</span>
                <strong>/api/statistics</strong> - æ•´é«”çµ±è¨ˆè³‡æ–™
                <p>æä¾›ç¸½ç‰©ä»¶æ•¸ã€åƒ¹æ ¼åˆ†æã€ç™¼å¸ƒè€…åˆ†å¸ƒç­‰çµ±è¨ˆè³‡è¨Š</p>
            </div>

            <div class="api-endpoint">
                <span class="method-get">GET</span>
                <strong>/api/house-types</strong> - æˆ¿å±‹é¡å‹åˆ—è¡¨
                <p>å–å¾—æ‰€æœ‰æˆ¿å±‹é¡å‹çš„ ID å’Œåç¨±å°æ‡‰è¡¨</p>
            </div>

            <div class="api-endpoint">
                <span class="method-get">GET</span>
                <strong>/api/poster-types</strong> - ç™¼å¸ƒè€…é¡å‹åˆ—è¡¨
                <p>å–å¾—æ‰€æœ‰ç™¼å¸ƒè€…é¡å‹çš„ ID å’Œåç¨±å°æ‡‰è¡¨</p>
            </div>

            <div class="api-endpoint">
                <span class="method-get">GET</span>
                <strong>/health</strong> - å¥åº·æª¢æŸ¥
                <p>æª¢æŸ¥ API æœå‹™ç‹€æ…‹å’Œç›¸é—œä¾è³´æœå‹™</p>
            </div>
        </div>

        <button class="collapsible">ğŸ’¡ ä½¿ç”¨æŠ€å·§èˆ‡æœ€ä½³å¯¦è¸</button>
        <div class="content">
            <h4>ğŸ¯ æœå°‹æœ€ä½³åŒ–</h4>
            <ul>
                <li><strong>åˆ†é æŸ¥è©¢</strong>ï¼šå»ºè­°æ¯æ¬¡æœ€å¤šæŸ¥è©¢ 50 ç­†è³‡æ–™ä»¥ç²å¾—æœ€ä½³æ•ˆèƒ½</li>
                <li><strong>æ¢ä»¶çµ„åˆ</strong>ï¼šå¯åŒæ™‚ä½¿ç”¨å¤šå€‹ç¯©é¸æ¢ä»¶ï¼Œä¾‹å¦‚ï¼šæˆ¿å±‹é¡å‹ + åƒ¹æ ¼ç¯„åœ + é—œéµå­—</li>
                <li><strong>å¿«å–åˆ©ç”¨</strong>ï¼šç›¸åŒæŸ¥è©¢æ¢ä»¶æœƒè‡ªå‹•ä½¿ç”¨å¿«å–ï¼Œæä¾›æ›´å¿«å›æ‡‰é€Ÿåº¦</li>
            </ul>

            <h4>ğŸ”’ è³‡æ–™å®‰å…¨</h4>
            <ul>
                <li><strong>æ‰‹æ©Ÿé®ç½©</strong>ï¼šAPI è‡ªå‹•å°æ‰‹æ©Ÿè™Ÿç¢¼é€²è¡Œé®ç½©è™•ç†ï¼ˆä¾‹ï¼š09****123ï¼‰</li>
                <li><strong>å€‹è³‡ä¿è­·</strong>ï¼šç¬¦åˆå€‹è³‡æ³•è¦ç¯„ï¼Œä¿è­·ä½¿ç”¨è€…éš±ç§</li>
            </ul>

            <h4>ğŸ“Š å›æ‡‰æ ¼å¼</h4>
            <div class="response-example">
                <strong>æ¨™æº–æˆåŠŸå›æ‡‰ï¼š</strong>
                <pre>{
  "success": true,
  "data": [...],
  "count": 10,
  "from_cache": false
}</pre>
            </div>
        </div>

        <button class="collapsible">ğŸ› éŒ¯èª¤è™•ç†èˆ‡ç–‘é›£æ’è§£</button>
        <div class="content">
            <h4>å¸¸è¦‹éŒ¯èª¤é¡å‹</h4>
            <ul>
                <li><strong>500 Internal Server Error</strong>ï¼šä¼ºæœå™¨å…§éƒ¨éŒ¯èª¤ï¼Œè«‹æª¢æŸ¥åƒæ•¸æ ¼å¼</li>
                <li><strong>åƒæ•¸éŒ¯èª¤</strong>ï¼šè«‹ç¢ºèª house_type_id (1-5) å’Œ poster_type_id (0-2) ç¯„åœ</li>
                <li><strong>æŸ¥è©¢é€¾æ™‚</strong>ï¼šå»ºè­°æ¸›å°‘æŸ¥è©¢ç­†æ•¸æˆ–ç¸®å°æŸ¥è©¢ç¯„åœ</li>
            </ul>

            <h4>é™¤éŒ¯å»ºè­°</h4>
            <ul>
                <li>å…ˆä½¿ç”¨ <code>/health</code> ç«¯é»æª¢æŸ¥æœå‹™ç‹€æ…‹</li>
                <li>ä½¿ç”¨åŸºæœ¬æŸ¥è©¢ <code>/api/properties?limit=1</code> æ¸¬è©¦é€£æ¥</li>
                <li>æª¢æŸ¥ Console ä¸­çš„éŒ¯èª¤è¨Šæ¯</li>
            </ul>
        </div>

        <div class="privacy-note">
            <strong>ğŸ›¡ï¸ éš±ç§ä¿è­·èªªæ˜ï¼š</strong>
            ç‚ºä¿è­·ç”¨æˆ¶éš±ç§ï¼Œæœ¬ API å°æ‰‹æ©Ÿè™Ÿç¢¼é€²è¡Œæ™ºèƒ½é®ç½©è™•ç†ã€‚ä¾‹å¦‚ï¼š
            <code>0912345678</code> â†’ <code>09****678</code>ï¼Œ
            <code>04-22334455</code> â†’ <code>04****455</code>
        </div>
    </div>

    <div class="quick-links">
        <h3>ğŸš€ ä¸€éµæ¸¬è©¦é€£çµ</h3>
        <a href="/api/properties?limit=5" target="_blank">ğŸ  åŸºæœ¬æœå°‹ (5ç­†)</a>
        <a href="/api/properties?house_type_id=2&limit=5" target="_blank">ğŸ¢ é›»æ¢¯å¤§æ¨“</a>
        <a href="/api/properties?poster_type_id=0&limit=5" target="_blank">ğŸ‘¤ æˆ¿æ±ç‰©ä»¶</a>
        <a href="/api/properties?min_price=15000&max_price=40000&limit=8" target="_blank">ğŸ’° åƒ¹æ ¼ç¯©é¸</a>
        <a href="/api/properties?keyword=å°ä¸­&limit=5" target="_blank">ğŸ” é—œéµå­—æœå°‹</a>
        <a href="/api/statistics" target="_blank">ğŸ“Š çµ±è¨ˆè³‡æ–™</a>
        <a href="/health" target="_blank">â¤ï¸ å¥åº·æª¢æŸ¥</a>

        <div class="mapping-info">
            <strong>ğŸ“‹ è³‡æ–™æ˜ å°„åƒè€ƒï¼š</strong><br>
            <strong>ğŸ  æˆ¿å±‹é¡å‹ (house_type_id):</strong> 1=é€å¤©å, 2=é›»æ¢¯å¤§æ¨“, 3=å…¬å¯“, 4=åˆ¥å¢…, 5=å…¶ä»–(åœè»Šä½)<br>
            <strong>ğŸ‘¥ ç™¼å¸ƒè€…é¡å‹ (poster_type_id):</strong> 0=æˆ¿æ±, 1=æˆ¿ä»², 2=ä»£ç†äºº<br>
            <strong>ğŸ’° åƒ¹æ ¼ç¯„åœï¼š</strong> å»ºè­°ä½¿ç”¨ 15,000-50,000 é€²è¡Œæ¸¬è©¦
        </div>
    </div>

    <div id="swagger-ui"></div>

    <script src="https://unpkg.com/swagger-ui-dist@5.0.0/swagger-ui-bundle.js"></script>
    <script src="https://unpkg.com/swagger-ui-dist@5.0.0/swagger-ui-standalone-preset.js"></script>
    <script>
        // æŠ˜ç–ŠåŠŸèƒ½
        document.addEventListener('DOMContentLoaded', function() {
            var coll = document.getElementsByClassName("collapsible");
            for (var i = 0; i < coll.length; i++) {
                coll[i].addEventListener("click", function() {
                    this.classList.toggle("active");
                    var content = this.nextElementSibling;
                    if (content.classList.contains("show")) {
                        content.classList.remove("show");
                    } else {
                        content.classList.add("show");
                    }
                });
            }
        });

        window.onload = function() {
            // ç²å–ç•¶å‰é é¢çš„åŸºç¤ URL
            const currentUrl = window.location.origin.replace('http:', 'https:');

            const ui = SwaggerUIBundle({
                url: currentUrl + '/api/swagger.json',
                dom_id: '#swagger-ui',
                deepLinking: true,
                presets: [
                    SwaggerUIBundle.presets.apis,
                    SwaggerUIStandalonePreset
                ],
                plugins: [
                    SwaggerUIBundle.plugins.DownloadUrl
                ],
                layout: "StandaloneLayout",
                tryItOutEnabled: true,
                requestInterceptor: function(req) {
                    console.log('ğŸ“¤ ç™¼é€è«‹æ±‚:', req.url);
                    // ç¢ºä¿æ‰€æœ‰è«‹æ±‚éƒ½ä½¿ç”¨æ­£ç¢ºçš„åŸºç¤ URL
                    if (req.url && !req.url.startsWith('http')) {
                        req.url = currentUrl + req.url;
                    }
                    // å¦‚æœ URL æ˜¯ httpï¼Œæ”¹ç‚º https
                    if (req.url && req.url.startsWith('http://')) {
                        req.url = req.url.replace('http://', 'https://');
                    }
                    return req;
                },
                responseInterceptor: function(res) {
                    console.log('ğŸ“¥ æ”¶åˆ°å›æ‡‰:', res.status, res.url);
                    return res;
                },
                onComplete: function() {
                    console.log("âœ… Swagger UI è¼‰å…¥å®Œæˆ");
                },
                onFailure: function(error) {
                    console.error('âŒ Swagger UI è¼‰å…¥å¤±æ•—:', error);
                },
                validatorUrl: null, // ç¦ç”¨ç·šä¸Šé©—è­‰
                docExpansion: "list", // é è¨­å±•é–‹æ¨¡å¼
                filter: true, // å•Ÿç”¨ç¯©é¸åŠŸèƒ½
                showRequestHeaders: true,
                showCommonExtensions: true,
                defaultModelsExpandDepth: 2,
                defaultModelExpandDepth: 2,
                supportedSubmitMethods: ['get', 'post', 'put', 'delete', 'patch'],
                operationsSorter: 'alpha',
                tagsSorter: 'alpha'
            });

            // è‡ªå®šç¾©æ¨£å¼èª¿æ•´
            setTimeout(function() {
                // éš±è— Swagger é è¨­çš„ topbar
                const topbar = document.querySelector('.swagger-ui .topbar');
                if (topbar) {
                    topbar.style.display = 'none';
                }

                // èª¿æ•´å…§å®¹å€åŸŸçš„ padding
                const wrapper = document.querySelector('.swagger-ui .wrapper');
                if (wrapper) {
                    wrapper.style.paddingTop = '0';
                }

                // æ·»åŠ è‡ªå®šç¾©æç¤º
                const infoSection = document.querySelector('.swagger-ui .info');
                if (infoSection) {
                    const tip = document.createElement('div');
                    tip.innerHTML = `
                        <div style="background: #e8f4fd; padding: 15px; border-radius: 6px; margin: 15px 0; border-left: 4px solid #2196F3;">
                            <strong>ğŸ’¡ ä½¿ç”¨æç¤ºï¼š</strong>
                            <ul style="margin: 10px 0; padding-left: 20px;">
                                <li>é»æ“Šä»»ä¸€ API ç«¯é»å±•é–‹è©³ç´°èªªæ˜</li>
                                <li>é»æ“Š "Try it out" æŒ‰éˆ•é€²è¡Œå¯¦éš›æ¸¬è©¦</li>
                                <li>å¡«å…¥åƒæ•¸å¾Œé»æ“Š "Execute" åŸ·è¡ŒæŸ¥è©¢</li>
                                <li>æŸ¥çœ‹ä¸‹æ–¹çš„å›æ‡‰çµæœå’Œç‹€æ…‹ç¢¼</li>
                            </ul>
                        </div>
                    `;
                    infoSection.appendChild(tip);
                }
            }, 2000);
        }
    </script>

    <style>
        /* é¡å¤–çš„è‡ªå®šç¾©æ¨£å¼ */
        .swagger-ui .info {
            margin: 20px 0;
        }
        .swagger-ui .info hgroup.main {
            margin: 0 0 20px 0;
        }
        .swagger-ui .info .title {
            font-size: 28px;
            color: #3b4151;
        }
        .swagger-ui .scheme-container {
            background: #fff;
            box-shadow: none;
            padding: 20px;
            border-radius: 4px;
            margin-bottom: 20px;
        }
        .swagger-ui .opblock .opblock-summary {
            border-color: #3498db;
        }
        .swagger-ui .opblock.opblock-get {
            border-color: #27ae60;
            background: rgba(39, 174, 96, 0.1);
        }
        .swagger-ui .opblock.opblock-get .opblock-summary-method {
            background: #27ae60;
        }
        .swagger-ui .execute-wrapper {
            padding: 20px;
            text-align: center;
        }
        .swagger-ui .btn.execute {
            background: #3498db;
            border-color: #3498db;
            color: #fff;
            font-weight: bold;
            padding: 12px 24px;
            font-size: 16px;
            border-radius: 6px;
            transition: all 0.2s ease;
        }
        .swagger-ui .btn.execute:hover {
            background: #2980b9;
            border-color: #2980b9;
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(52, 152, 219, 0.3);
        }

        /* åŠ å¼·å›æ‡‰å€åŸŸçš„æ¨£å¼ */
        .swagger-ui .responses-inner {
            padding: 20px;
            background: #f8f9fa;
            border-radius: 6px;
        }

        .swagger-ui .response-col_description {
            font-size: 14px;
            line-height: 1.5;
        }
    </style>
</body>
</html>